---
title: "Hiking trails"
author: "Viola Nguyen, Hedidi Tsang"
date: "12 kwietnia 2019"
output: output: 
  html_document:
    cold_folding: hide
---

Determining the trail difficulty levels at the Macleish Field Station (based on their length and change in elevation)


```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r, message= FALSE, warning=FALSE}
# Loading libraries ----
library(macleish)
library(sf)
library(raster)
library(dplyr)
library(leaflet)
library(ggplot2)
library(rgdal)
library(rgeos)
```


```{r}
# Loading macleish layers ----
data("macleish_layers")
class(macleish_layers)
```

```{r}
contours<-macleish_layers[["contours_30ft"]]
```

```{r}
# Importing GIS data for Whately  ----
gis_whately <- "http://download.massgis.digital.mass.gov/shapefiles/contours5k/hp337.zip"
download.file(gis_whately, destfile = basename(gis_whately))
unzip("hp337.zip", exdir = "whately_contours")
```

```{r}
# Transforming Whately countours into matching projection
whately_GIS <- path.expand("whately_contours")
whately_cont <- readOGR(whately_GIS, "hp337") %>%
  spTransform(CRS("+init=epsg:4326"))
```

```{r}
# Importing GIS data for Conway ----
gis_conway <- "http://download.massgis.digital.mass.gov/shapefiles/contours5k/hp68.zip"
download.file(gis_conway, destfile = basename(gis_conway))
unzip("hp68.zip", exdir = "conway_contours")
```

```{r}
# Transforming Conway countours into matching projection ----
conway_GIS <- path.expand("conway_contours")
conway_cont <- readOGR(conway_GIS, "hp68") %>%
  spTransform(CRS("+init=epsg:4326"))
```

```{r}
# Merging contours for Conway and Whately into one polygon ----
macleish_boundaries <-
  gUnion(conway_cont, whately_cont)
```

```{r}
# Polygon intersection with Macleish layer ----
macleish_boundaries %>%
  gIntersection(macleish_layers[['boundary']])
```

```{r}
# Removing Whately and Conway contours ----
trail_points <- macleish_boundaries %>%
  gIntersection(macleish_layers[['trails']])
```


```{r, message=FALSE}
# Creating the interactive map (with contours and trails) ----
map1 <- leaflet() %>%
  addTiles() %>%
  addPolylines(data = macleish_boundaries, weight = 1, color = "black") %>%
  addPolylines(data = macleish_layers[["boundary"]], weight = 3, color = "green") %>%
  addPolylines(data = macleish_layers[["trails"]], weight = 3) %>%
  addCircleMarkers(data = trail_points, radius = 2, color = "purple") %>% addMeasure(activeColor="yellow")
map1
```



